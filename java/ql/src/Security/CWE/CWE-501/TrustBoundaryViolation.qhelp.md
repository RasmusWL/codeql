A trust boundary violation occurs when a value is passed from a less trusted context to a more trusted context.

For example, a value that is generated by a less trusted source, such as a user, may be passed to a more trusted source, such as a system process. If the less trusted source is malicious, then the value may be crafted to exploit the more trusted source.

Trust boundary violations are often caused by a failure to validate input. For example, if a web application accepts a cookie from a user, then the application should validate the cookie before using it. If the cookie is not validated, then the user may be able to craft a malicious cookie that exploits the application.


## Recommendation
To maintain a trust boundary, validate data from less trusted sources before use.


## Example
In the first (bad) example, the server accepts a parameter from the user, then uses it to set the username without validation.

{% sample src="TrustBoundaryVulnerable.java" %}
In the second (good) example, the server validates the parameter from the user, then uses it to set the username.

{% sample src="TrustBoundaryFixed.java" %}

## References
* Wikipedia: [Trust boundary](http://en.wikipedia.org/wiki/Trust_boundary).
{% cwe-references %}
